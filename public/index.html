<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Calculadora Polinomios</title>
        <link rel="stylesheet" href="styles.css" />
    </head>
    <body>
        <h1 class="text-3xl text-center text- text-blue-800 font-serif font-extrabold shadow-lg">Calculadora de Polinomios</h1>

        <form autocomplete="off">
            <fieldset>
                <div class="mt-4 space-y-4 mx-5">
                    <select class="shadow border rounded w-full py-2 px-3 text-grey-darker" id="tipo">
                        <option value=""></option>
                        <option value="newton" selected>Newton</option>
                        <option value="Lagrange">Lagrange</option>
                    </select>
                </div>
            </fieldset>
            <fieldset>
                <div class="mt-4 space-y-4 mx-5">
                    <select class="shadow border rounded w-full py-2 px-3 text-grey-darker" id="pontos">
                        <option value=""></option>
                        <option value="3">3</option>
                        <option value="4" selected>4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                    </select>
                </div>
            </fieldset>
            <div class="my-15">
                <table class="rounded-t-lg m-5 w-5/6 mx-auto bg-gray-200 text-gray-800 text-center">
                    <tr class="text-center border-b-2 border-gray-300">
                      <th class="px-4 py-3">X</th>
                      <th class="px-4 py-3">F(x)</th>
                    </tr>
                    
                    <tr class="bg-gray-100 border-b border-gray-200">
                        <td class="px-4 py-3">
                            <input class="shadow appearance-none border rounded w-20 py-2 px-3 text-grey-darker" id="x0" type="text" placeholder="x0">
                        </td>
                        <td class="px-4 py-3">
                            <input class="shadow appearance-none border rounded w-20 py-2 px-3 text-grey-darker" id="fx0" type="text" placeholder="F(x0)">
                        </td>
                    </tr> 
                    <tr class="bg-gray-100 border-b border-gray-200">
                        <td class="px-4 py-3">
                            <input class="shadow appearance-none border rounded w-20 py-2 px-3 text-grey-darker" id="x1" type="text" placeholder="x1">
                        </td>
                        <td class="px-4 py-3">
                            <input class="shadow appearance-none border rounded w-20 py-2 px-3 text-grey-darker" id="fx1" type="text" placeholder="F(x1)">
                        </td>
                    </tr> 
                    <tr class="bg-gray-100 border-b border-gray-200" id="linha_3">
                        <td class="px-4 py-3">
                            <input class="shadow appearance-none border rounded w-20 py-2 px-3 text-grey-darker" id="x2" type="text" placeholder="x2">
                        </td>
                        <td class="px-4 py-3">
                            <input class="shadow appearance-none border rounded w-20 py-2 px-3 text-grey-darker" id="fx2" type="text" placeholder="F(x2)">
                        </td>
                    </tr> 
                    <tr class="bg-gray-100 border-b border-gray-200" id="linha_4">
                        <td class="px-4 py-3">
                            <input class="shadow appearance-none border rounded w-20 py-2 px-3 text-grey-darker" id="x3" type="text" placeholder="x3">
                        </td>
                        <td class="px-4 py-3">
                            <input class="shadow appearance-none border rounded w-20 py-2 px-3 text-grey-darker" id="fx3" type="text" placeholder="F(x3)">
                        </td>
                    </tr>
                    <tr class="bg-gray-100 border-b border-gray-200" id="linha_5" style="display: none;">
                        <td class="px-4 py-3">
                            <input class="shadow appearance-none border rounded w-20 py-2 px-3 text-grey-darker" id="x4" type="text" placeholder="x4">
                        </td>
                        <td class="px-4 py-3">
                            <input class="shadow appearance-none border rounded w-20 py-2 px-3 text-grey-darker" id="fx4" type="text" placeholder="F(x4)">
                        </td>
                    </tr> 
                    <tr class="bg-gray-100 border-b border-gray-200" id="linha_6" style="display: none;"> 
                        <td class="px-4 py-3">
                            <input class="shadow appearance-none border rounded w-20 py-2 px-3 text-grey-darker" id="x5" type="text" placeholder="x5">
                        </td>
                        <td class="px-4 py-3">
                            <input class="shadow appearance-none border rounded w-20 py-2 px-3 text-grey-darker" id="fx5" type="text" placeholder="F(x5)">
                        </td>
                    </tr> 
                  </table>
            </div>
            <center>
                <input type="button" value="Calcular" onclick="calcular();" class="w-60 py-3 mt-6 font-medium tracking-widest text-white uppercase bg-black shadow-lg focus:outline-none hover:bg-gray-900 hover:shadow-none">
            
                <div id="resultado_div" style="display: none;">
                    <h1 class="text-3xl text-center my-10 text-blue-800 font-serif font-extrabold shadow-lg">Resultados</h1>
                    <input type="text" id="resultado" class="text-3xl w-full text-center my-1 text-blue-800 font-serif font-extrabold" value="P(x)=">
                </div>
            </center>

        </form>

        <script>
            document.getElementById("pontos").addEventListener("change", function(){
                
                if(this.value == 3){
                    document.getElementById("linha_3").style.display = "table-row";
                    document.getElementById("linha_4").style.display = "none";
                    document.getElementById("linha_5").style.display = "none";
                    document.getElementById("linha_6").style.display = "none";
                    document.getElementById("resultado_div").style.display = "none";

                    var x0 = document.getElementById("x0").value = "";
                    var x1 = document.getElementById("x1").value = "";
                    var x2 = document.getElementById("x2").value = "";
                    var x3 = document.getElementById("x3").value = "";
                    var x4 = document.getElementById("x4").value = "";
                    var x5 = document.getElementById("x5").value = "";

                    var fx0 = document.getElementById("fx0").value = "";
                    var fx1 = document.getElementById("fx1").value = "";
                    var fx2 = document.getElementById("fx2").value = "";
                    var fx3 = document.getElementById("fx3").value = "";
                    var fx4 = document.getElementById("fx4").value = "";
                    var fx5 = document.getElementById("fx5").value = "";
                }else if(this.value == 4){
                    document.getElementById("linha_3").style.display = "table-row";
                    document.getElementById("linha_4").style.display = "table-row";
                    document.getElementById("linha_5").style.display = "none";
                    document.getElementById("linha_6").style.display = "none";
                    document.getElementById("resultado_div").style.display = "none";

                    var x0 = document.getElementById("x0").value = "";
                    var x1 = document.getElementById("x1").value = "";
                    var x2 = document.getElementById("x2").value = "";
                    var x3 = document.getElementById("x3").value = "";
                    var x4 = document.getElementById("x4").value = "";
                    var x5 = document.getElementById("x5").value = "";

                    var fx0 = document.getElementById("fx0").value = "";
                    var fx1 = document.getElementById("fx1").value = "";
                    var fx2 = document.getElementById("fx2").value = "";
                    var fx3 = document.getElementById("fx3").value = "";
                    var fx4 = document.getElementById("fx4").value = "";
                    var fx5 = document.getElementById("fx5").value = "";
                }else if(this.value == 5){
                    document.getElementById("linha_3").style.display = "table-row";
                    document.getElementById("linha_4").style.display = "table-row";
                    document.getElementById("linha_5").style.display = "table-row";
                    document.getElementById("linha_6").style.display = "none";
                    document.getElementById("resultado_div").style.display = "none";

                    var x0 = document.getElementById("x0").value = "";
                    var x1 = document.getElementById("x1").value = "";
                    var x2 = document.getElementById("x2").value = "";
                    var x3 = document.getElementById("x3").value = "";
                    var x4 = document.getElementById("x4").value = "";
                    var x5 = document.getElementById("x5").value = "";

                    var fx0 = document.getElementById("fx0").value = "";
                    var fx1 = document.getElementById("fx1").value = "";
                    var fx2 = document.getElementById("fx2").value = "";
                    var fx3 = document.getElementById("fx3").value = "";
                    var fx4 = document.getElementById("fx4").value = "";
                    var fx5 = document.getElementById("fx5").value = "";
                }else if(this.value == 6){
                    document.getElementById("linha_3").style.display = "table-row";
                    document.getElementById("linha_4").style.display = "table-row";
                    document.getElementById("linha_5").style.display = "table-row";
                    document.getElementById("linha_6").style.display = "table-row";
                    document.getElementById("resultado_div").style.display = "none";

                    var x0 = document.getElementById("x0").value = "";
                    var x1 = document.getElementById("x1").value = "";
                    var x2 = document.getElementById("x2").value = "";
                    var x3 = document.getElementById("x3").value = "";
                    var x4 = document.getElementById("x4").value = "";
                    var x5 = document.getElementById("x5").value = "";

                    var fx0 = document.getElementById("fx0").value = "";
                    var fx1 = document.getElementById("fx1").value = "";
                    var fx2 = document.getElementById("fx2").value = "";
                    var fx3 = document.getElementById("fx3").value = "";
                    var fx4 = document.getElementById("fx4").value = "";
                    var fx5 = document.getElementById("fx5").value = "";
                }else {
                    document.getElementById("linha_3").style.display = "table-row";
                    document.getElementById("linha_4").style.display = "none";
                    document.getElementById("linha_5").style.display = "none";
                    document.getElementById("linha_6").style.display = "none";
                    document.getElementById("resultado_div").style.display = "none";

                    var x0 = document.getElementById("x0").value = "";
                    var x1 = document.getElementById("x1").value = "";
                    var x2 = document.getElementById("x2").value = "";
                    var x3 = document.getElementById("x3").value = "";
                    var x4 = document.getElementById("x4").value = "";
                    var x5 = document.getElementById("x5").value = "";

                    var fx0 = document.getElementById("fx0").value = "";
                    var fx1 = document.getElementById("fx1").value = "";
                    var fx2 = document.getElementById("fx2").value = "";
                    var fx3 = document.getElementById("fx3").value = "";
                    var fx4 = document.getElementById("fx4").value = "";
                    var fx5 = document.getElementById("fx5").value = "";
                }
            })

            function calcular(){
                var tipo = document.getElementById("tipo").value;
                if(tipo === ""){
                    alert("Selecione um tipo de calculo");
                }else{
                    
                    var pontos = document.getElementById("pontos").value;
                    var x0 = document.getElementById("x0").value;
                    var x1 = document.getElementById("x1").value;
                    var x2 = document.getElementById("x2").value;
                    var x3 = document.getElementById("x3").value;
                    var x4 = document.getElementById("x4").value;
                    var x5 = document.getElementById("x5").value;

                    var fx0 = document.getElementById("fx0").value;
                    var fx1 = document.getElementById("fx1").value;
                    var fx2 = document.getElementById("fx2").value;
                    var fx3 = document.getElementById("fx3").value;
                    var fx4 = document.getElementById("fx4").value;
                    var fx5 = document.getElementById("fx5").value;

                    if(tipo === "newton"){
                        var d1 = new Array();
                        var d2 = new Array();
                        var d3 = new Array();
                        var d4 = new Array();
                        var d5 = new Array();
                        
                        //tabela de 3 pontos
                        if(pontos == 3){
                            d1[0] = (fx1 - fx0)/(x1 - x0);
                            d1[1] = (fx2 - fx1)/(x2 - x1);

                            d2[0] = (d1[1] - d1[0])/(x2 - x0);

                            aux_x2 = d2[0];
                            aux_x1 = d1[0] - (d2[0] * x1) - (d2[0] * x0);
                            aux_c = fx0 - (d1[0] * x0) + (d2[0] * x1 * x0);


                            var resultado = "P(x) = "+aux_x2.toFixed(1)+"x²";
                            if(aux_x1 >= 0){
                                resultado = resultado.concat(" + "+aux_x1.toFixed(1)+"x");
                            }else{
                                resultado = resultado.concat(" "+aux_x1.toFixed(1)+"x");
                            }

                            if(aux_c >= 0){
                                resultado = resultado.concat(" + "+aux_c.toFixed(1));
                            }else{
                                resultado = resultado.concat(" "+aux_c.toFixed(1));
                            }

                        //tabela de 4 pontos
                        }else if(pontos == 4){
                            //Diferencas de divisao
                                //Delta 1
                            d1[0] = (fx1 - fx0)/(x1 - x0);
                            d1[1] = (fx2 - fx1)/(x2 - x1);
                            d1[2] = (fx3 - fx2)/(x3 - x2);


                                //Delta 2
                            d2[0] = (d1[1] - d1[0])/(x2 - x0);
                            d2[1] = (d1[2] - d1[1])/(x3 - x1);

                                //Delta 3
                            d3[0] = (d2[1] - d2[0])/(x3 - x0);

                            var aux_x3 = d3[0];
                            var aux_x2 = d2[0] - (d3[0] * x2) - (d3[0] * x1) - (d3[0] * x0);
                            var aux_x1 = d1[0] - (d2[0] * x1) - (d2[0] * x0) + (d3[0] * x2 * x1) + (d3[0] * x2 * x0) + (d3[0] * x0 * x1);
                            var aux_c = fx0 - (d1[0] * x0) + (d2[0] * x0 * x1) - (d3[0] * x2 * x1 * x0);
                            
                            //var p = fx0 + (parseInt("x") - x0)d1[0] + (parseInt("x") - x0)(parseInt("x") - x1)d2[0] + (parseInt("x")-x0)(parseInt("x")-x1)*(parseInt("x")-x2)*d3;
                            //var resultado = p.replace("NaNNaNNaN", "x³");

                            var resultado = "P(x) = "+aux_x3.toFixed(1)+"x³";

                            if(aux_x2 >= 0){
                                resultado = resultado.concat(" + "+aux_x2.toFixed(1)+"x²");
                            }else{
                                resultado = resultado.concat(" "+aux_x2.toFixed(1)+"x²");
                            }

                            if(aux_x1 >= 0){
                                resultado = resultado.concat(" + "+aux_x1.toFixed(1)+"x");
                            }else{
                                resultado = resultado.concat(" "+aux_x1.toFixed(1)+"x");
                            }

                            if(aux_c >= 0){
                                resultado = resultado.concat(" + "+aux_c.toFixed(1));
                            }else{
                                resultado = resultado.concat(" "+aux_c.toFixed(1));
                            }
                        
                        //tabela de 5 pontos
                        }else if(pontos == 5){
                            d1[0] = (fx1 - fx0)/(x1 - x0);
                            d1[1] = (fx2 - fx1)/(x2 - x1);
                            d1[2] = (fx3 - fx2)/(x3 - x2);
                            d1[3] = (fx4 - fx3)/(x4 - x3);

                            d2[0] = (d1[1] - d1[0])/(x2 - x0);
                            d2[1] = (d1[2] - d1[1])/(x3 - x1);
                            d2[2] = (d1[3] - d1[2])/(x4 - x2);

                            d3[0] = (d2[1] - d2[0])/(x3 - x0);
                            d3[1] = (d2[2] - d2[1])/(x4 - x1);

                            d4[0] = (d3[1] - d3[0])/(x4 - x0);

                            var aux_x4 = d4[0];
                            var aux_x3 = d3[0] - (d4[0] * x2) - (d4[0] * x1) - (d4[0] * x0) - (d4[0] * x3);
                            var aux_x2 = d2[0] - (d3[0] * x2) - (d3[0] * x1) - (d3[0] * x0) + (d4[0] * x1 * x2) + (d4[0] * x0 * x2) + (d4[0] * x0 * x1) + (d4[0] * x0 * x3) + (d4[0] * x1 * x3) + (d4[0] * x2 * x3);
                            var aux_x1 = d1[0] - (d2[0] * x1) - (d2[0] * x0) + (d3[0] * x1 * x2) + (d3[0] * x0 * x2) + (d3[0] * x0 * x1) - (d4[0] * x0 * x1 * x2) - (d4[0] * x0 * x1 * x3) - (d4[0] * x0 * x2 * x3) - (d4[0] * x1 * x2 * x3);
                            var aux_c = fx0 - (d1[0] * x0) + (d2[0] * x0 * x1) - (d3[0] * x0 * x1 * x2) + (d4[0] * x0 * x1 * x2 * x3);

                            var resultado = "P(x) = "+aux_x4.toFixed(1)+"x⁴";

                            if(aux_x3 >= 0){
                                resultado = resultado.concat(" + "+aux_x3.toFixed(1)+"x³");
                            }else{
                                resultado = resultado.concat(" "+aux_x3.toFixed(1)+"x³");
                            }

                            if(aux_x2 >= 0){
                                resultado = resultado.concat(" + "+aux_x2.toFixed(1)+"x²");
                            }else{
                                resultado = resultado.concat(" "+aux_x2.toFixed(1)+"x²");
                            }

                            if(aux_x1 >= 0){
                                resultado = resultado.concat(" + "+aux_x1.toFixed(1)+"x");
                            }else{
                                resultado = resultado.concat(" "+aux_x1.toFixed(1)+"x");
                            }

                            if(aux_c >= 0){
                                resultado = resultado.concat(" + "+aux_c.toFixed(1));
                            }else{
                                resultado = resultado.concat(" "+aux_c.toFixed(1));
                            }
                        }else if(pontos == 6){
                            d1[0] = (fx1 - fx0)/(x1 - x0);
                            d1[1] = (fx2 - fx1)/(x2 - x1);
                            d1[2] = (fx3 - fx2)/(x3 - x2);
                            d1[3] = (fx4 - fx3)/(x4 - x3);
                            d1[4] = (fx5 - fx4)/(x5 - x4);

                            d2[0] = (d1[1] - d1[0])/(x2 - x0);
                            d2[1] = (d1[2] - d1[1])/(x3 - x1);
                            d2[2] = (d1[3] - d1[2])/(x4 - x2);
                            d2[3] = (d1[4] - d1[3])/(x5 - x3);

                            d3[0] = (d2[1] - d2[0])/(x3 - x0);
                            d3[1] = (d2[2] - d2[1])/(x4 - x1);
                            d3[2] = (d2[3] - d2[2])/(x5 - x2);

                            d4[0] = (d3[1] - d3[0])/(x4 - x0);
                            d4[1] = (d3[2] - d3[1])/(x5 - x1);

                            d5[0] = (d4[1] - d4[0])/(x5 - x0);

                            var aux_x5 = d5[0];
                            var aux_x4 = d4[0] - (d5[0] * x2) - (d5[0] * x1) - (d5[0] * x0) - (d5[0] * x4) - (d5[0] * x3);
                            var aux_x3 = d3[0] - (d4[0] * x2) - (d4[0] * x1) - (d4[0] * x0) + (d5[0] * x1 * x2) + (d5[0] * x0 * x2) + (d5[0] * x0 * x1) + (d5[0] * x2 * x4) + (d5[0] * x1 * x4) + (d5[0] * x0 * x4) - (d4[0] * x3) + (d5[0] * x0 * x3) + (d5[0] * x1 * x3) + (d5[0] * x2 * x3) + (d5[0] * x4 * x3);
                            var aux_x2 = d2[0] - (d3[0] * x2) - (d3[0] * x1) - (d3[0] * x0) + (d4[0] * x1 * x2) + (d4[0] * x0 * x2) + (d4[0] * x0 * x1) - (d5[0] * x0 * x1 * x2) - (d5[0] * x1 * x2 * x4) - (d5[0] * x0 * x2 * x4) - (d5[0] * x0 * x1 * x4) + (d4[0] * x0 * x3) + (d4[0] * x3 * x1) + (d4[0] * x3 * x2) - (d5[0] * x0 * x1 * x3) - (d5[0] * x0 * x2 * x3) - (d5[0] * x0 * x4 * x3) - (d5[0] * x1 * x2 * x3) - (d5[0] * x1 * x4 * x3) - (d5[0] * x2 * x3 * x4);
                            var aux_x1 = d1[0] - (d2[0] * x1) - (d2[0] * x0) + (d3[0] * x1 * x2) + (d3[0] * x0 * x2) + (d3[0] * x0 * x1) - (d4[0] * x0 * x1 * x2) + (d5[0] * x0 * x1 * x2 * x4) - (d4[0] * x0 * x1 * x3) - (d4[0] * x0 * x2 * x3) - (d4[0] * x1 * x2 * x3) + (d5[0] * x0 * x1 * x2) + (d5[0] * x0 * x1 * x4) + (d5[0] * x0 * x2 * x4) + (d5[0] * x1 * x2 * x4);
                            var aux_c = fx0 - (d1[0] * x1) + (d2[0] * x0 * x1) - (d3[0] * x0 * x1 * x2) + (d4[0] * x0 * x1 * x2 * x3) - (d5[0] * x0 * x1 * x2 * x3 * x4);
                        
                            var resultado = "P(x) = "+aux_x5.toFixed(1)+"x⁵";

                            if(aux_x4 >= 0){
                                resultado = resultado.concat(" + "+aux_x4.toFixed(1)+"x⁴");
                            }else{
                                resultado = resultado.concat(" "+aux_x4.toFixed(1)+"x⁴");
                            }

                            if(aux_x3 >= 0){
                                resultado = resultado.concat(" + "+aux_x3.toFixed(1)+"x³");
                            }else{
                                resultado = resultado.concat(" "+aux_x3.toFixed(1)+"x³");
                            }

                            if(aux_x2 >= 0){
                                resultado = resultado.concat(" + "+aux_x2.toFixed(1)+"x²");
                            }else{
                                resultado = resultado.concat(" "+aux_x2.toFixed(1)+"x²");
                            }

                            if(aux_x1 >= 0){
                                resultado = resultado.concat(" + "+aux_x1.toFixed(1)+"x");
                            }else{
                                resultado = resultado.concat(" "+aux_x1.toFixed(1)+"x");
                            }

                            if(aux_c >= 0){
                                resultado = resultado.concat(" + "+aux_c.toFixed(1));
                            }else{
                                resultado = resultado.concat(" "+aux_c.toFixed(1));
                            }
                        }


                        document.getElementById("resultado_div").style.display = "block";
                        document.getElementById("resultado").value = resultado;
                    }
                }
            }
        </script>
    </body>
</html>